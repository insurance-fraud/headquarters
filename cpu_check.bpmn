<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" id="Definitions_126u8pe" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="2.2.4">
  <bpmn:process id="check_cpu" name="Check CPU" isExecutable="true">
    <bpmn:sequenceFlow id="SequenceFlow_1g5nfp8" sourceRef="StartEvent_1" targetRef="check-cpu-usage" />
    <bpmn:sequenceFlow id="SequenceFlow_1abyg3e" sourceRef="check-cpu-usage" targetRef="decide-based-on-cpu" />
    <bpmn:sequenceFlow id="cpu-usage-high" name="CPU usage high" sourceRef="decide-based-on-cpu" targetRef="send-email">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${highUsage == true}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_0zvwxvf" name="CPU usage low" sourceRef="decide-based-on-cpu" targetRef="cpu-low-end">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${highUsage == false}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:endEvent id="cpu-low-end" name="CPU usage is low">
      <bpmn:incoming>SequenceFlow_0zvwxvf</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:startEvent id="StartEvent_1" name="Every minute">
      <bpmn:outgoing>SequenceFlow_1g5nfp8</bpmn:outgoing>
      <bpmn:timerEventDefinition>
        <bpmn:timeCycle xsi:type="bpmn:tFormalExpression">0 0/1 * * * ?</bpmn:timeCycle>
      </bpmn:timerEventDefinition>
    </bpmn:startEvent>
    <bpmn:endEvent id="cpu-high-end" name="High CPU usage alert sent to Admins">
      <bpmn:incoming>SequenceFlow_1kspx4n</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="SequenceFlow_1kspx4n" sourceRef="send-email" targetRef="cpu-high-end" />
    <bpmn:inclusiveGateway id="decide-based-on-cpu" name="Decide based on CPU usage">
      <bpmn:incoming>SequenceFlow_1abyg3e</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0zvwxvf</bpmn:outgoing>
      <bpmn:outgoing>cpu-usage-high</bpmn:outgoing>
    </bpmn:inclusiveGateway>
    <bpmn:serviceTask id="check-cpu-usage" name="Check CPU usage" camunda:type="external" camunda:topic="check-cpu-usage">
      <bpmn:incoming>SequenceFlow_1g5nfp8</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1abyg3e</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:serviceTask id="send-email" name="Send email to Admins" camunda:type="external" camunda:topic="send-email">
      <bpmn:incoming>cpu-usage-high</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1kspx4n</bpmn:outgoing>
    </bpmn:serviceTask>
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="check_cpu">
      <bpmndi:BPMNEdge id="SequenceFlow_1g5nfp8_di" bpmnElement="SequenceFlow_1g5nfp8">
        <di:waypoint x="208" y="319" />
        <di:waypoint x="258" y="319" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1abyg3e_di" bpmnElement="SequenceFlow_1abyg3e">
        <di:waypoint x="358" y="319" />
        <di:waypoint x="408" y="319" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_08aq6uu_di" bpmnElement="cpu-usage-high">
        <di:waypoint x="433" y="294" />
        <di:waypoint x="433" y="220" />
        <di:waypoint x="604" y="220" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="464" y="199" width="81" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0zvwxvf_di" bpmnElement="SequenceFlow_0zvwxvf">
        <di:waypoint x="433" y="344" />
        <di:waypoint x="433" y="429" />
        <di:waypoint x="824" y="429" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="509" y="405" width="76" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="EndEvent_01y8i83_di" bpmnElement="cpu-low-end">
        <dc:Bounds x="824" y="411" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="799" y="454" width="87" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="StartEvent_0r7eujm_di" bpmnElement="StartEvent_1">
        <dc:Bounds x="172" y="301" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="158" y="344" width="65" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="EndEvent_1jg6w7a_di" bpmnElement="cpu-high-end">
        <dc:Bounds x="824" y="202" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="801" y="245" width="82" height="40" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_1kspx4n_di" bpmnElement="SequenceFlow_1kspx4n">
        <di:waypoint x="704" y="220" />
        <di:waypoint x="824" y="220" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="InclusiveGateway_0wi1tm0_di" bpmnElement="decide-based-on-cpu">
        <dc:Bounds x="408" y="294" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="472" y="309" width="83" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ServiceTask_1dazamm_di" bpmnElement="check-cpu-usage">
        <dc:Bounds x="258" y="279" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ServiceTask_1d34ifd_di" bpmnElement="send-email">
        <dc:Bounds x="604" y="180" width="100" height="80" />
      </bpmndi:BPMNShape>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
